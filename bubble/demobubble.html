<meta charset="utf-8">
<head>
  <title>Force layout (x axis)</title>
</head>

<style>

.q0-9 { fill:#5e7b92; }
.q1-9 { fill:#91c5ae; }
.q2-9 { fill:#eda686; }
.q3-9 { fill:#c02c59; }


</style>

<body>
  <div id="content">
    <svg width="1200" height="200">
      <g transform="translate(100, 100)"></g>
    </svg>
  </div>
  <script type = "text/javascript" src="../move.json"></script>
  <script type = "text/javascript" src="../demographic-data.json"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.2.2/d3.min.js"></script>

  <script>

      console.log("hello");
var width = 1000, height = 200;

var xScale = d3.scaleLinear().domain([0, 5]).range([0, 1000]);

var move_dict = d3.map();
og_data.forEach( function(d){ move_dict.set( d.fips, d.move_index) });

var county_dict = d3.map();
og_data.forEach( function(d){ county_dict.set( d.fips, d.county) });

var dem_dict = d3.map();
dem_data.forEach( function(d){ dem_dict.set( d.fips, d.per_gop)});

var quantize = d3.scaleQuantize()
    .domain([0, 4])
    .range(d3.range(4).map(function(i) { 
        if (i == 0)
            return "#5e7b92";
        else if (i == 1)
            return "#91c5ae";
        else if (i == 2)
            return "#eda686";
        else
            return "#c02c59";
    }))

var numNodes = 30;
var nodes = move_dict.keys().map(function(d) {
    return {
        radius: 5,
        value: move_dict.get(d)[4],
        gop: dem_dict.get(d) * 5,
        color: quantize(move_dict.get(d)[4])
    }
});

var simulation = d3.forceSimulation(nodes)
  .force('x', d3.forceX().x(function(d) {
    return xScale(d.gop);
  }))
  .force('y', d3.forceY().y(function(d) {
    return 0;
  }))
  .force('collision', d3.forceCollide().radius(function(d) {
    return d.radius;
  }))
  .force('charge', d3.forceManyBody().strength(-2))
  .on('tick', ticked);

function ticked() {
  var u = d3.select('svg g')
    .selectAll('circle')
    .data(nodes);

  u.enter()
    .append('circle')
    .attr('r', function(d) {
      return d.radius;
    })
    .style('fill', function(d) {
        console.log(d.color);
      return d.color;
    })
    .merge(u)
    .attr('cx', function(d) {
      return d.x;
    })
    .attr('cy', function(d) {
      return d.y;
    })

  u.exit().remove();
}
</script>
</body>
</html>